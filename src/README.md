# QRAM.BAS
```basic
10 |BANKOPEN,130
20 DEFINT a-z
30 k$="                                                                                                                                                                                                                                                   "
40 FOR t=1 TO 501:|BANKWRITE,r%,k$,t:NEXT
50 DIM codint$(100),Fart$(30)
60 WER=0:AUTOM=0:IMPRES$="NO":fil=1:QWE=1:MODE 2
65 WINDOW #1,2,78,24,24   
70 WINDOW #2,3,78,7,14
80 WINDOW #3,18,78,17,21
90 WINDOW #4,25,56,5,21 
100 WINDOW #5,27,54,6,20 
110 WINDOW #7,3,19,2,2
120 BORDER 0:INK 0,0:INK 1,26:INK 3,26:INK 2,6,0:PEN 3:PAPER 0:GRAPHICS PEN 3
130 MOVE 0,0:DRAWR 639,0:DRAWR 0,399:DRAWR -639,0:DRAWR 0,-400:MOVE 1,0:DRAWR 0,400:MOVE 638,0:DRAWR 0,400:MOVE 0,360:DRAWR 640,0:MOVE 590,360:DRAWR 0,50:MOVE 589,360:DRAWR 0,50:MOVE 0,40:DRAWR 640,0:MOVE 0,166:DRAWR 640,0
140 MOVE 400,360:DRAWR 0,100:MOVE 235,360:DRAWR 0,100
150 LOCATE 3,5:PRINT"1. ARTICULO : "; 
160 PAPER #2,0
170 LOCATE 3,17:PRINT"2. REVISTA  : ";
180 LOCATE 3,19:PRINT"3. FECHA    : ";  
190 LOCATE 3,21:PRINT"4. CODIGO   : "; 
200 TAG:MOVE 425,385:PRINT "Fichas Filtro : ";fil-1;:TAGOFF
210 GRAPHICS PEN 1:TAG:MOVE 17,385:PRINT"FICHERO : ";FICH$;"      ";:TAGOFF
220 GOTO 1120
230 REM ********************** INTRODUCCION DATOS *************************
240 CLEAR INPUT:PAPER #4,0:CLS#4:GRAPHICS PEN 3:MOVE 0,166:DRAWR 640,0
250 GOSUB 450
260 MOVE 0,166:DRAWR 640,0
270 REM*************************** IMPRESO0RA *******************************
280 ZONE 60:PRINT#8,CHR$(27)"!"CHR$(4)
290 PRINT#8," ";QWE,:QWE=QWE+1:PRINT#8,"CODIGO BUSQUEDA : ";BW$(ZX2)
300 PRINT#8,CHR$(27)"!"CHR$(20);ARTi$
310 PRINT#8,CHR$(27)"!"CHR$(4)  
320 ZONE 60:PRINT#8,"      0. FICHERO  :   ";FICH$,"3. FECHA  :   ";FECi$
330 ZONE 60:PRINT#8,"      1. N. FICHA :  ";Im,"4. CODIGO :   ";CODi$  
340 PRINT#8,"      2. REVISTA  :   ";REVi$,
350 PRINT#8,CHR$(27)"!"CHR$(56);"                ";CODI$;CHR$(27)"!"CHR$(4)
360 ZONE 8
370 PRINT#8,STRING$(132,"-")
380 RETURN
390 Fart$(fil)=art$(AS):Frev$(fil)=rev$(as):Ffec$(fil)=fec$(as)
400 Fcod$(fil)=cod$(as)+"&"+STR$(as)
410 fil=fil+1:JA=AS+1
420 TAG:MOVE 425,385:PRINT "Fichas Filtro : ";fil-1;:TAGOFF
430 SOUND 1,30,10
440 RETURN
450 REM ********************* ANALIZADOR TECLADO *************************
460 x=x+1:CLS#2:CLS#3:GRAPHICS PEN 3
470 TAG:MOVE 17,28:PRINT SPC(76);:MOVE 5,28:PRINT"  M .... MENU      A .... ANTERIOR       S .... SIGUIENTE       SPC .... CONT";:MOVE 257,385:PRINT"Fmax (100) : ";fmax;:TAGOFF
480 GOTO 610
490 CLEAR INPUT:MOVE 0,166:DRAWR 640,0
500 GOTO 510
510 IF INKEY(14)=0 THEN CHIV=2:GOTO 680
520 IF INKEY(13)=0 THEN CHIV=1:GOTO 630  
530 IF INKEY(5)=0 THEN CHIV=3:GOTO 740 
540 IF INKEY(38)=0 THEN  xmax=x:GOTO 1120  
550 IF INKEY(47)=0 THEN GOSUB 920:GOTO 460
560 IF INKEY(20)=0 THEN CHIV=4:GOTO 800  
570 IF INKEY(6)=0 THEN CHIV=CHIV+1:GOTO 860
580 IF INKEY(60)=0 THEN 970
590 IF INKEY(69)=0  THEN 990   
600 GOTO 500
610 REM********************* ACCION **************************
620 CLS#2:CLS#3
630 CLEAR INPUT:PRINT CHR$(&18):LOCATE 3,5:PRINT"1. ARTICULO :":MOVE 16,336:DRAWR 103,0:PRINT CHR$(&18) 
640 IF x>99 THEN XXXX=594 ELSE XXXX=600
650  TAG:MOVE XXXX,385:PRINT x;:TAGOFF
660 LOCATE #2,1,1:LINE INPUT #2,"",art$:art$=UPPER$(art$):CLEAR INPUT
670 LOCATE 3,5:PRINT"1. ARTICULO :":GRAPHICS PEN 0:MOVE 16,336:DRAWR 135,0:GRAPHICS PEN 3:CHIV=1:GOTO 500
680 REM********************* INDICACIONES **************************
690 CLEAR INPUT:PRINT CHR$(&18):LOCATE 3,17:PRINT"2. REVISTA  :":MOVE 16,144:DRAWR 103,0:PRINT CHR$(&18) 
700 LOCATE 18,17:LINE INPUT "",rev$:rev$=UPPER$(rev$)
710 IF rev$=" " THEN rev$=rev2$:LOCATE 18,17:PRINT rev$:GOTO 730 
720 rev2$=rev$
730 CLEAR INPUT:LOCATE 3,17:PRINT"2. REVISTA  :":GRAPHICS PEN 0:MOVE 16,144:DRAWR 135,0:GRAPHICS PEN 3:GOTO 500
740 REM********************* CONTRAINDICACION **************************
750 CLEAR INPUT :PRINT CHR$(&18):LOCATE 3,19:PRINT"3. FECHA    :":MOVE 16,112:DRAWR 103,0:PRINT CHR$(&18)  
760 LOCATE 18,19:LINE INPUT "",fec$:fec$=UPPER$(fec$)
770 IF FEC$=" " THEN fec$=fec2$:LOCATE 18,19:PRINT fec$:GOTO 790
780 fec2$=fec$
790 CLEAR INPUT:LOCATE 3,19:PRINT"3. FECHA    :":GRAPHICS PEN 0:MOVE 16,112:DRAWR 135,0:GRAPHICS PEN 3:GOTO 500
800 REM********************* EFECTOS 2 **************************
810 CLEAR INPUT:PRINT CHR$(&18):LOCATE 3,21:PRINT"4. CODIGO   :":MOVE 16,80:DRAWR 103,0:PRINT CHR$(&18) 
820 LOCATE 18,21:LINE INPUT "",cod$:cod$=UPPER$(cod$)
830 IF cod$=" " THEN cod$=cod2$:LOCATE 18,21:PRINT cod$:GOTO 850
840 cod2$=cod$  
850 CLEAR INPUT:LOCATE 3,21:PRINT"4. CODIGO   :":GRAPHICS PEN 0:MOVE 16,80:DRAWR 135,0:GRAPHICS PEN 3:GOTO 500
860 REM ******************** SALTO AUTOMATICO ***************************
870 IF CHIV=1 THEN 610
880 IF CHIV=2 THEN 680
890 IF CHIV=3 THEN 750  
900 IF CHIV=4 THEN 800   
910 IF CHIV=5 THEN CHIV=0:GOSUB 920:|BANKWRITE,r%,k$,x:codint$(f)=asd$:x=x+1:TAG:MOVE 257,385:PRINT"Fmax (100) : ";fmax;:TAGOFF:GOTO 610
920 REM **********************************************
930 asd$=rev$+"#"+fec$+"&"+cod$
940 IF asd$<>asd2$ THEN f=fmax+1:codint$(f)=asd$:asd2$=asd$:fmax=f
950 k$=STR$(f)+"!"+art$
960 RETURN
970 REM******************* SIGUIENTE / ANTERIOR **************************
980 X=X+1:GOTO 1000
990 X=X-1:IF x=0 THEN x=1
1000 CLS #2:CLS#3 
1010 k$="                                                                                                                                                       "
1020 CLEAR INPUT
1030 IF x>99 THEN XXXX=594 ELSE XXXX=600
1040 TAG:MOVE XXXX,385:PRINT x;:TAGOFF
1050 |BANKREAD,r%,k$,x
1060 gh=INSTR(K$,"!"):art$=MID$(k$,gh+1):GOSUB 2570 
1070 LOCATE #2,1,1:PRINT #2,Art$
1080 LOCATE 18,17:PRINT Rev$
1090 LOCATE 18,19:PRINT Fec$
1100 LOCATE 18,21:PRINT Cod$
1110 GOTO 500
1120 REM *************************  MENU ********************************
1130 GOSUB 2160
1140 LOCATE 33,7:PRINT"I ..... INTRODUCIR"
1150 LOCATE 33,9:PRINT"P ..... IMPRESORA"
1160 LOCATE 33,11:PRINT"B ..... BUSCAR"
1170 LOCATE 33,13:PRINT"S ..... SALVAR"    
1180 LOCATE 33,15:PRINT"L ..... CARGAR"    
1190 LOCATE 33,17:PRINT"X ..... FIN"   
1200 LOCATE 31,19:PRINT"N. FICHAS ...... ";Xmax
1210 IF INKEY(35)=0 THEN X=XMAX :GOTO 230 
1220 IF INKEY(27)=0 THEN 3310 
1230 IF INKEY(63)=0 THEN 1280
1240 IF INKEY(60)=0 THEN 1470  
1250 IF INKEY(36)=0 THEN GOSUB 1630:GOTO 1130   
1260 IF INKEY(54)=0 THEN 1790 
1270 GOTO 1210
1280 REM************************** FIN **********************************
1290 CLEAR INPUT:CLS#5
1300 LOCATE 28,10:PRINT"Â¿ HAS  MODIFICADO FICHAS ?"
1310 LOCATE 36,12:PRINT"( S / N )"
1320 LOCATE 30,19:PRINT"( Return .... ANULAR )"
1330 IF INKEY(60)=0 THEN CLS#5:GOTO 1370
1340 IF INKEY(18)=0 OR INKEY(6)=0 THEN CLS#5:GOTO 1140
1350 IF INKEY(46)=0 THEN MODE 2:STOP
1360 GOTO 1330
1370 LOCATE 36,12:PRINT"SALVANDO"    
1380 |ERA,"jano2.*"
1390 OPENOUT "jano2" 
1400 WRITE #9,xMAX
1410 FOR co=1 TO xMAX 
1420 WRITE #9,art$(co),rev$(co),fec$(co),cod$(co)
1430 NEXT
1440 CLOSEOUT
1450 MODE 2
1460 STOP
1470 REM *************************
1480 CLEAR INPUT:CLS#5
1490 LOCATE 30,7:PRINT"*** SALVAR FICHERO ***":LOCATE 30,19:PRINT"( Return .... ANULAR )":LOCATE 31,10:PRINT"NOMBRE FICHERO : ":LOCATE 34,12:LINE INPUT "",FIC$
1500 IF fic$="" THEN CLS #5:GOTO 1140   
1510 OPENOUT FIC$
1520 WRITE #9,xMAX
1530 FOR co=1 TO xMAX
1540 K$="                                                                                                                                                                        "
1550 |BANKREAD,r%,k$,co:ton=INSTR(k$,"         "):k2$=MID$(k$,1,ton):WRITE #9,k2$
1560 NEXT   
1570 WRITE #9,fmax
1580 FOR x=1 TO fmax
1590 WRITE #9,codint$(x)
1600 NEXT
1610 CLOSEOUT    
1620 GOTO 1120
1630 REM *********************** CARGAR ******************************
1640 CLS#5:CLEAR INPUT:LOCATE 30,7:PRINT"*** CARGAR FICHERO ***":LOCATE 30,19:PRINT"( Return .... ANULAR )":LOCATE 31,10:PRINT"NOMBRE FICHERO : ":LOCATE 34,12:LINE INPUT "",FIC$
1650 IF fic$="" THEN CLS #5:GOTO 1140
1660 co=-3
1670 OPENIN fic$
1680 INPUT #9,xfin
1690 FOR coo=1 TO xfin    
1700 INPUT #9,k$:|BANKWRITE,r%,k$,coo 
1710 NEXT
1720 IF rfc$="#&" THEN 1760
1730 INPUT #9,fmax
1740 FOR x=1 TO fmax
1750 INPUT #9,codint$(x)
1760 NEXT
1770 CLOSEIN
1780 x=xfin:xmax=xfin:GRAPHICS PEN 1:TAG:MOVE 17,385:PRINT"FICHERO : ";UPPER$(FIC$);"      ";:TAGOFF:fich$=UPPER$(fic$):RETURN
1790 REM************************ BUSCAR ********************************
1800 CLS#5:TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF:CLEAR INPUT
1810 LOCATE 30,7:PRINT"* BUSCAR / MODIFICAR *"
1820 LOCATE 34,9:PRINT"M .... MODIFICAR"
1830 LOCATE 34,11:PRINT"B .... BUSCAR"
1840 LOCATE 34,13:PRINT"K .... BORRAR"
1850 LOCATE 34,15:PRINT"V .... VER FICHAS"
1860 LOCATE 34,17:PRINT"I .... INIC. FILTRO"
1870 LOCATE 30,19:PRINT"( Return .... ANULAR )"
1880 IF INKEY(6)=0 OR INKEY(18)=0 THEN CLS#5:GOTO 1140
1890 IF INKEY(54)=0 THEN 2970  
1900 IF INKEY(55)=0 THEN 2150
1910 IF INKEY(37)=0 THEN 2520 
1920 IF INKEY(38)=0 THEN 2630
1930 IF INKEY(35)=0 THEN 1950
1940 GOTO 1880
1950 REM******************************************************
1960 TAG:MOVE 425,385:PRINT "Fichas Filtro :    ";:GRAPHICS PEN 1:fil=1:TAG:MOVE 425,385:PRINT "Fichas Filtro : ";fil-1;:TAGOFF:SOUND 1,230,10: GOTO 1940
1970 REM************************* BUSQUEDA ****************************
1980 CLEAR INPUT
1990 PAPER #4,0:CLS#4:GRAPHICS PEN 3:MOVE 0,166:DRAWR 640,0:CLS#3:CLS#2:TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF:GRAPHICS PEN 0:MOVE 432,2:DRAWR 0,37:GRAPHICS PEN 1
2000 GOTO 2220
2010 IF INKEY(38)=0 THEN GOTO  1120
2020 IF INKEY(60)=0 OR INKEY(6)=0  OR INKEY(18)=0 THEN xc=xc+1:GOTO 2220
2030 IF INKEY(34)=0 THEN CLS#2:CLS#3:CLEAR INPUT:GOTO 2170
2040 IF INKEY(69)=0 THEN XC=XC-1:GOTO 2210 
2050 IF INKEY(35)=0 THEN Im=XC:arti$=ART$(XC):REVI$=REV$(XC):FECI$=FEC$(XC):CODI$=COD$(XC):BW$="":GOSUB 270     
2055 GOTO 2010
2060 CLEAR INPUT:PAPER #4,0:CLS#4:GRAPHICS PEN 3:MOVE 0,166:DRAWR 640,0:CLS#2:CLS#3:TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF:GRAPHICS PEN 0:MOVE 432,2:DRAWR 0,37:GRAPHICS PEN 1
2070 TAG:MOVE 17,28:PRINT SPC(76);:MOVE 17,29:PRINT"NUMERO DE FICHA : ";:TAGOFF:LOCATE 21,24:INPUT "",XK
2080 IF XK=0 THEN GOSUB 2160:GOTO 1790
2090 IF XK>XMAX THEN 20000
2100 LOCATE 21,24:PRINT"             ":as=xk:dodichi=1:GOSUB 2530
2110 TAG:MOVE 17,28:PRINT"                            BORRAR  ( S / N )                             ";:MOVE 600,385:PRINT XK;:TAGOFF
2120 IF INKEY(46)=0 THEN CLEAR INPUT:GOTO 2070
2130 IF INKEY(60)=0 THEN 2150     
2140 GOTO 2120
2150 art$(xk)="":rev$(xk)="":fec$(xk)="":cod$(xk)="":CLS#2:CLS#3:TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF:CLEAR INPUT:GOTO 2070
2160 REM ********************** GOSUB CUADRO *****************************
2170 TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF:PAPER #4,3:CLS #4:PAPER #5,0:CLS #5:GRAPHICS PEN 0
2180 MOVE 210,315:DRAWR -20,21:MOVE 210,316:DRAWR -20,22:MOVE 425,315:DRAWR 22,21:MOVE 426,315:DRAWR 23,21:MOVE 210,84:DRAWR -20,-21:MOVE 210,83:DRAWR -20,-22:MOVE 430,80:DRAWR 26,-22:MOVE 429,80:DRAWR 25,-22:RETURN
2190 REM******************  BUSQUEDA POR UN CAMPO ****************************
2200 CLEAR INPUT:CLS #3:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF
2210 as2=0
2220 REM************* ACCIONES *********
2230 CLS#3:CLS#2:LOCATE #2,1,1:PRINT#2,"1. ":PRINT#2,"2. ":PRINT#2,"3. ":PRINT#2,"4. ":PRINT#2,"5. ":PRINT#2,"6. ":PRINT#2,"7. ":PRINT#2,"8. ":TAG:MOVE 17,28:PRINT"INTRODUCE CODIGO(S) DE BUSQUEDA (Maximo 8).            Return ... FINAL";:TAGOFF
2240 FOR ZXC=1 TO 8:LOCATE #2,4,ZXC:LINE INPUT #2," ",ACCB$(ZXC):BW$(ZXC)=ACCB$(ZXC):accb$(ZXC)=UPPER$(accb$(ZXC)):IF ACCB$(ZXC)="" THEN 2250 ELSE NEXT
2250 IF zxc>1 THEN 2260 ELSE GOSUB 2160:GOTO 1790
2260 JA=1:GF=0:as=0
2270 IF AUTOM=5 THEN GOSUB 3470   
2280 TAG:MOVE 17,28:PRINT SPC(75);:MOVE 17,28:PRINT "SPC ... Detener Busqueda";:TAGOFF
2290 IF mn=1 THEN mn=0:GOTO 2450
2300 FOR AS=JA TO XMAX
2310 IF INKEY(47)=0 THEN GOSUB 3400
2320 IF as>99 THEN XXXX=594 ELSE XXXX=600
2330 IF filt=1 THEN GOSUB 3170:GOTO 2370
2340 TAG:MOVE XXXX,385:PRINT as;:TAGOFF 
2350 k$="                                                                                                                                                 "
2360 |BANKREAD,r%,k$,as:accm$=UPPER$(k$):gh=INSTR(accm$,"!"):accm$=MID$(accm$,gh+1,128)
2370 FOR ZX2=1 TO ZXC-1:IF INSTR(accM$,accb$(ZX2))<>0 THEN cd1=4:GOSUB 2750:ja=as+1:GOTO 2290 ELSE NEXT
2380 NEXT
2390 IF VB<>0 THEN 3470
2400 TAG:MOVE 17,28:PRINT SPC(76);:TAGOFF
2410 IF GF=1 AND AUTOM=5 THEN 3340 
2420 IF GF=1 THEN TAG:MOVE 17,28:PRINT"                            NO HAY MAS FICHAS";:TAGOFF:CLEAR INPUT:CALL &BB16:GOTO 2440
2430 TAG:MOVE 17,28:PRINT"                           NO EXISTE ESA FICHA";:TAGOFF:CALL &BB16:GOTO 2440
2440 TAG:MOVE 17,28:PRINT"    F .... FILTRO     M .... MENU     S .... SIGUIENTE     O .... OTRA";:TAGOFF
2450 CLEAR INPUT
2460 IF INKEY(60)=0 THEN JA=AS+1:GOTO 2300
2470 IF INKEY(34)=0 THEN 2190
2480 IF INKEY(38)=0 THEN GRAPHICS PEN 0:GOTO  1120
2490 IF INKEY(53)=0 THEN GOSUB 3630
2500 IF INKEY(35)=0 THEN Im=as:arti$=tART$:REVI$=rev$:FECI$=FEC$:CODI$=COD$:GOSUB 270
2510 GOTO 2460
2520 REM ******************** GOSUB PRESENTACION *************************
2530 REM*********** f$=MID$(k$,1,gh-1):f=VAL(f$)
2540 IF AS>99 THEN XXXX=594 ELSE XXXX=600        
2550 IF filt=1 THEN GOSUB 3630:GOTO 2620 
2560 GOSUB 2570:GOTO 2610
2570 IF gh=0 THEN 500 ELSE fx$=MID$(k$,1,gh-1):fx=VAL(fx$)
2580 qq=INSTR(codint$(fx),"#"):rev$=MID$(codint$(fx),1,qq-1)
2590 ww=INSTR(codint$(fx),"&"):fec$=MID$(codint$(fx),qq+1,ww-qq-1)
2600 cod$=MID$(codint$(fx),ww+1,6):RETURN
2610 TAG:MOVE 594,385:PRINT"    ";:gf=1:MOVE 17,28:PRINT SPC(76);:TAGOFF:CLS #3:CLS#2:TAG:MOVE XXXX,385:PRINT AS;:TAGOFF:tart$=accm$:trev$=rev$:tfec$=fec$:tcod$=cod$:GOTO 2640
2620 IF nm2>99 THEN XXXX=594 ELSE XXXX=600
2630 TAG:MOVE 594,385:PRINT"    ";:MOVE XXXX,385:PRINT nm2;:TAGOFF
2640 LOCATE #2,1,1:PRINT #2,tART$
2650 LOCATE 18,17:PRINT trev$
2660 LOCATE 18,19:PRINT tfec$
2670 LOCATE 18,21:PRINT tcod$
2680 IF VB<>0 THEN 3590
2690 IF dodichi=1 THEN dodichi=0:RETURN
2700 TAG:MOVE 17,28:PRINT"   F .... FILTRO      M .... MENU      S .... SIGUIENTE      O .... OTRA";:MOVE 257,385:PRINT"I .... IMPRIMIR  ";:TAGOFF
2710 lk=1:cd1=cd1z:cd2=cd2z:cd3=cd3z:cd4=cd4z:gf=1:mn=1:jk=jkk:ja=As+1:RETURN
2750 REM************ ANALIZADOR VARIOS CAMPOS ****************
2760 REM IF jk=1 THEN GOSUB 3580:F=F2:RETURN
2770 GOSUB 2530:F=F2:RETURN
2780 REM******************** CONTROL CENTRAL BUSQUEDA *****************
2790 CLEAR INPUT
2800 GOSUB 2160:GOTO 1790
2810 REM********************* BUSCA RAM *******************
2820 ja2=1
2830 FOR t=ja2 TO xmax
2840 |BANKREAD,r%,k$,t:bn=INSTR(k$,"!"):clave=VAL(MID$(k$,1,bn-1)):art$=MID$(k$,bn+1)
2850 IF f=clave THEN nm2=t:GOSUB 2610:ja2=t+1:GOTO 2830
2860 LOCATE 24,24:PRINTF
2870 NEXT
2880 REM******************************************************************
2890 GRAPHICS PEN 1:TAG:MOVE 17,385:PRINT "FICHERO : ";FICH$;:TAGOFF
2900 OPENIN FICH$
2910 INPUT #9,xfin
2920 FOR co=1 TO xfin
2930 INPUT #9,Art$(co),Rev$(co),Fec$(co),Cod$(co)
2940 NEXT
2950 CLOSEIN
2960 x=xfin:xmax=xfin:RETURN
2970 REM********************************************************************
2980 CLS #5:CLEAR INPUT
2990 LOCATE 34,7:PRINT "F .... FILTRO"  
3000 LOCATE 34,9:PRINT "1 .... FICHAS-1"
3010 LOCATE 34,11:PRINT "2 .... FICHAS-2"
3020 LOCATE 34,13:PRINT "3 .... FICHAS-3"
3030 LOCATE 34,15:PRINT "0 .... AUTOMATICO"
3040 LOCATE 32,17:PRINT "SPC .... F. MEMORIA"
3050 LOCATE 30,19:PRINT"( Return .... ANULAR )"
3060 IF INKEY(6)=0 OR INKEY(18)=0 THEN CLS#5:GOTO 1790
3070 IF INKEY(53)=0 THEN FILT=1:GRAPHICS PEN 1:TAG:MOVE 17,385:PRINT"FICHERO : FILTRO     ";:TAGOFF:GOTO 1970  
3080 IF INKEY(13)=0 THEN FIC$="FICHAS1":CLEAR INPUT:CLS #3:CLS #2:PAPER #4,0:GRAPHICS PEN 1:CLS#4:MOVE 0,166:DRAWR 600,0:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF:GOSUB 1670:FILT=0:GOTO 2190
3090 IF INKEY(14)=0 THEN FIC$="FICHAS2":CLEAR INPUT:CLS #3:CLS #2:PAPER #4,0:GRAPHICS PEN 1:CLS#4:MOVE 0,166:DRAWR 600,0:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF:GOSUB 1670:FILT=0:GOTO 2190
3100 IF INKEY(5)=0 THEN FIC$="FICHAS3":CLEAR INPUT:CLS #3:CLS #2:PAPER #4,0:GRAPHICS PEN 1:CLS#4:MOVE 0,166:DRAWR 600,0:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF:GOSUB 1670:FILT=0:GOTO 2190
3110 IF INKEY(47)=0 THEN GRAPHICS PEN 1:TAG:MOVE 17,385:PRINT"FICHERO : ";FICH$;"      ";:TAGOFF:CLEAR INPUT:CLS #3:CLS #2:PAPER #4,0:GRAPHICS PEN 1:CLS#4:MOVE 0,166:DRAWR 600,0:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF:GOTO 2190
3120 IF INKEY(15)=0 THEN 30000
3130 GOTO 3060
3140 REM********************************************************** 
3150 IF as>=fil THEN 3240   
3160 TAG:MOVE 555,385:PRINT as;:TAGOFF:INCM$=UPPER$(fFEC$(as)):nm=INSTR(fcod$(as),"&"):nm$=MID$(fcod$(as),nm+1):nm2=VAL(nm$):RETURN
3170 REM**********************************************************
3180 as2=as2+1
3190 IF as>=fil THEN 2400
3200 TAG:MOVE 555,385:PRINT as2;:TAGOFF:pl=INSTR(fart$(as2),"?"):pl2=INSTR(fart$(as2),"!"):accm$=MID$(fart$(as2),pl2+1,pl-pl2-1):gh=pl:K$=fart$(as2):RETURN  
3210 REM*********************************************************
3220 CLS #5:CLEAR INPUT
3230 LOCATE 31,7:PRINT "COPY .... BUSCAR"    
3240 LOCATE 34,9:PRINT "1 .... FICHAS-1"
3250 LOCATE 34,11:PRINT "2 .... FICHAS-2"
3260 LOCATE 34,13:PRINT "3 .... FICHAS-3"
3270 LOCATE 34,15:PRINT "0 .... TODOS"
3280 LOCATE 30,19:PRINT"( Return .... ANULAR )"
3290 CLEAR INPUT
3300 IF INKEY(6)=0 OR INKEY(18)=0 THEN CLS#5:GOTO 2970
3310 IF INKEY(15)=0 THEN 30000
3320 IF INKEY(9)=0 THEN AUTOM=5:GOTO 2190
3330 GOTO 3300
3340 REM********************************************************
3350 WER=WER+1
3360 IF WER=1 THEN FIC$="JANO-1":GOSUB 1670:GOTO 2290
3370 IF WER=2 THEN FOR sd=1 TO 120:ARt$(sd)="":REV$(sd)="":FEC$(sd)="":COD$(sd)="":NEXT:FIC$="JANO-2":GOSUB 1670:ja=0:GOTO 2290
3380 IF WER=3 THEN FOR sd=1 TO 120:ARt$(sd)="":REV$(sd)="":FEC$(sd)="":COD$(sd)="":NEXT:FIC$="JANO-3":GOSUB 1670:ja=0:GOTO 2290 
3390 IF WER=4 THEN AUTOM=0:WER=0:GRAPHICS PEN 0:GOSUB 2090:GOSUB 2160:GOTO 2970
3400 REM *********************************************************
3410 TAG:MOVE 17,28:PRINT SPC(75);:TAGOFF
3420 TAG:MOVE 17,28:PRINT"CONTINUAR LA BUSQUEDA  ( S / N )";:TAGOFF
3430 CLEAR INPUT
3440 IF INKEY(60)=0 THEN CLEAR INPUT:TAG:MOVE 17,28:PRINT SPC(75);::MOVE 17,28:PRINT "SPC ... Detener Busqueda";:TAGOFF:RETURN
3450 IF INKEY(46)=0 THEN 1970
3460 GOTO 3440
3470 REM ************************ super automatico *********************
3480 IF VB=2 THEN vb=36:GOTO 2260
3490 IF VB=1 THEN 3550
3500 IF vb=-1 THEN 1120
3510 fic$="FICHAS1"
3520 GOSUB 1670
3530 VB=VB+1
3540 RETURN
3550 fic$="FICHAS2"
3560 GOSUB 1670
3570 VB=VB+1 
3580 AUTOM=0:GOTO 2280
3630 REM ******************** filt **************************
3638 as2=as
3639 Fart$(fil)=k$:fil=fil+1:TAG:MOVE 425,385:PRINT "Fichas Filtro : ";fil-1;:TAGOFF:SOUND 1,30,10:RETURN
30000 REM ***************** buscar todos **********************
30010 CLEAR INPUT:CLS #3:CLS #2:PAPER #4,0:GRAPHICS PEN 1:CLS#4:MOVE 0,166:DRAWR 600,0:TAG:MOVE 17,28:PRINT SPC(76);:MOVE 594,385:PRINT"    ";:TAGOFF
30020 as2=0:TAG:MOVE 257,385:PRINT"   AUTOMATICO   ";:TAGOFF
30030 CLS#3:CLS#2:LOCATE #2,1,1:PRINT#2,"1. ":PRINT#2,"2. ":PRINT#2,"3. ":PRINT#2,"4. ":PRINT#2,"5. ":PRINT#2,"6. ":PRINT#2,"7. ":PRINT#2,"8. ":TAG:MOVE 17,28:PRINT"INTRODUCE CODIGO(S) DE BUSQUEDA (Maximo 8).            Return ... FINAL";:TAGOFF
30040 FOR ZXC=1 TO 8:LOCATE #2,4,ZXC:LINE INPUT #2," ",ACCB$(ZXC):BW$(ZXC)=ACCB$(ZXC):accb$(ZXC)=UPPER$(accb$(ZXC)):IF ACCB$(ZXC)="" THEN 30300 ELSE NEXT
30050 IF zxc>1 THEN 2260 ELSE GOSUB 2160:GOTO 1790
30300 CLS #1:CLS #2
30304 fic$="fichas1":GOSUB 1670
30305 FOR AS=JA TO XMAX
30310 IF INKEY(47)=0 THEN GOSUB 3400
30320 IF as>99 THEN XXXX=594 ELSE XXXX=600
30340 TAG:MOVE XXXX,385:PRINT as;:TAGOFF 
30350 k$="                                                                                                                                                 "
30360 |BANKREAD,r%,k$,as:accm$=UPPER$(k$):gh=INSTR(accm$,"!"):accm$=MID$(accm$,gh+1,128)
30370 FOR ZX2=1 TO ZXC-1:IF INSTR(accM$,accb$(ZX2))<>0 THEN GOSUB 35000:ja=as+1:NEXT
30380 NEXT 
30390 IF zx=1 THEN zx=0:GOTO 1120
30400 fic$="fichas2":GOSUB 1670:ja=0:zx=1:TAG:MOVE 594,385:PRINT"    ";:MOVE 257,385:PRINT"                ";:TAGOFF:GOTO 30305  
35000 fx$=MID$(k$,1,gh-1):fx=VAL(fx$)
35010 qq=INSTR(codint$(fx),"#"):rev$=MID$(codint$(fx),1,qq-1)
35020 ww=INSTR(codint$(fx),"&"):fec$=MID$(codint$(fx),qq+1,ww-qq-1)
35030 cod$=MID$(codint$(fx),ww+1,6)
35040 IF nm2>99 THEN XXXX=594 ELSE XXXX=600 
35045 CLS #2:CLS #3
35050 LOCATE #2,1,1:PRINT #2,accm$:LOCATE 18,17:PRINT rev$:LOCATE 18,19:PRINT fec$:LOCATE 18,21:PRINT cod$
35060 ZONE 60:PRINT#8,CHR$(27)"!"CHR$(4)
35070 PRINT#8," ";QWE,:QWE=QWE+1:PRINT#8,"CODIGO BUSQUEDA : ";BW$(ZX2) 
35300 PRINT#8,CHR$(27)"!"CHR$(20);accm$
35310 PRINT#8,CHR$(27)"!"CHR$(4)  
35320 ZONE 60:PRINT#8,"      0. FICHERO  :   ";FICH$,"3. FECHA  :   ";FEC$
35330 ZONE 60:PRINT#8,"      1. N. FICHA :  ";as,"4. CODIGO :   ";COD$
35340 PRINT#8,"      2. REVISTA  :   ";REV$,
35350 PRINT#8,CHR$(27)"!"CHR$(56);"                ";COD$;CHR$(27)"!"CHR$(4)
35360 ZONE 8
35370 PRINT#8,STRING$(132,"-")
35375 FART$(L)=K$:L=L+1
35376 TAG:MOVE 425,385:PRINT "Fichas Filtro : ";fil2+1;:TAGOFF:FIL2=FIL2+1:SOUND 1,30,10
35380 RETURN
```

# Q9.BAS
```basic
10 ON BREAK CONT
20 ON ERROR GOTO 240
30 |BANKOPEN,0:GOTO 330
40 ON ERROR GOTO 270
50 sa=0:SYMBOL AFTER 256
60 ON ERROR GOTO 0
70 mcentry=HIMEM-15:MEMORY mcentry-1
80 FOR p=mcentry TO mcentry+15
90 READ p$:POKE p,VAL("&"+p$)
100 NEXT
110 a%=0:CALL mcentry,@a%
120 MEMORY mcentry+15
130 version=(a%\ 256)+256*(a%MOD256)
140 IF version<&102 THEN 320
150 mcentry=HIMEM-&524
160 ON ERROR GOTO 290
170 IF mcentry<=&7FFF THEN ERROR 7
180 MEMORY mcentry-1:LOAD "bankman.bin",mcentry
190 CALL mcentry
200 |BANKOPEN,0
210 IF sa=0 THEN SYMBOL AFTER 240
220 GOTO 330
230 DATA E,FF,CD,15,B9,EB,DD,66,1,DD,6E,0,73,23,72,C9
240 ' first |bankopen error
250 IF ERR=28 AND ERL=30 THEN RESUME 40
260 GOTO 320
270 ' catch bad SYMBOL AFTER command
280 sa=1:RESUME NEXT
290 ' error in main program
300 CLOSEIN:MEMORY mcentry+&524
310 IF sa=0 THEN SYMBOL AFTER 240
320 PRINT "Load Failed"
330 CLS:MODE 0:LOCATE 7,7:PRINT"Q R A M ":RUN"QRAM"
```
